<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.24">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Matt Hodges">
<meta name="dcterms.date" content="2025-04-21">

<title>GPT Finally Jumps Out of the System</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../img/favicon.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-a6e161b2431e1f94a14e0f5d32135a3c.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-2dbbbc70f266ee9aa1ae849862829066.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link href="https://fonts.googleapis.com/css2?family=Figtree:ital,wght@0,300..900;1,300..900&amp;display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<meta property="og:title" content="GPT Finally Jumps Out of the System">
<meta property="og:description" content="OpenAIâ€™s o4-mini-high Model Solves the MU Puzzle and Demonstrates Why">
<meta property="og:image" content="https://matthodges.com/posts/2025-04-21-openai-o4-mini-high-mu-puzzle/openai-o4-mini-high-mu-puzzle.jpeg">
<meta property="og:site_name" content="Matt Hodges">
<meta name="twitter:title" content="GPT Finally Jumps Out of the System">
<meta name="twitter:description" content="OpenAIâ€™s o4-mini-high Model Solves the MU Puzzle and Demonstrates Why">
<meta name="twitter:image" content="https://matthodges.com/posts/2025-04-21-openai-o4-mini-high-mu-puzzle/openai-o4-mini-high-mu-puzzle.jpeg">
<meta name="twitter:card" content="summary_large_image">
<link rel="canonical" href="https://matthodges.com/posts/2025-04-21-openai-o4-mini-high-mu-puzzle/" />
</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../index.html" class="navbar-brand navbar-brand-logo">
    </a>
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Matt Hodges</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="https://www.linkedin.com/in/hodgesmr" target="_blank"> 
<span class="menu-text">LinkedIn</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://github.com/hodgesmr" target="_blank"> 
<span class="menu-text">GitHub</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../posts.html"> 
<span class="menu-text">Posts</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="../../posts.xml"> <i class="bi bi-rss" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">GPT Finally Jumps Out of the System</h1>
            <p class="subtitle lead">OpenAIâ€™s o4-mini-high Model Solves the MU Puzzle and Demonstrates Why</p>
                      </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Matt Hodges </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">April 21, 2025</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
        
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<p>Well, theyâ€™ve done it. OpenAI released a model that can solve the <a href="https://en.wikipedia.org/wiki/MU_puzzle">MU Puzzle</a>. This has been my go-to test for GPTs since before ChatGPT was launched and models were only available in the Playground.</p>
<p>If youâ€™re unfamiliar with the puzzle, it was introduced by <a href="https://en.wikipedia.org/wiki/Douglas_Hofstadter">Douglas Hofstadter</a> in his Pulitzer-winning book <a href="https://en.wikipedia.org/wiki/G%C3%B6del,_Escher,_Bach">GÃ¶del, Escher, Bach</a>. The book explores how meaning can emerge from symbolic manipulation, and how formal systems like mathematics can be simultaneously powerful and fundamentally incomplete. The MU Puzzle, introduced early in the book, isnâ€™t just a quirky game. Itâ€™s a microcosm of formal systems. It was designed to make you feel clever while gently exposing the limits of mechanical reasoning. And its rules are simple:</p>
<p>Suppose there are the symbols <code>M</code>, <code>I</code>, and <code>U</code> which can be combined to produce strings of symbols. The MU puzzle asks one to start with the axiomatic string <code>MI</code> and transform it into the string <code>MU</code> using any combination of the available transformation rules:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 4%">
<col style="width: 16%">
<col style="width: 59%">
<col style="width: 19%">
</colgroup>
<thead>
<tr class="header">
<th>Rule</th>
<th>Formal</th>
<th>Informal</th>
<th>Example</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>x<code>I</code> â†’ x<code>IU</code></td>
<td>Add <code>U</code> to the end of any string that currently ends in <code>I</code>.</td>
<td><code>MI</code> to <code>MIU</code></td>
</tr>
<tr class="even">
<td>2</td>
<td><code>M</code>x â†’ <code>M</code>xx</td>
<td>Double the portion of the string that follows <code>M</code>.</td>
<td><code>MIU</code> to <code>MIUIU</code></td>
</tr>
<tr class="odd">
<td>3</td>
<td>x<code>III</code>y â†’ x<code>U</code>y</td>
<td>Replace any single instance of the substring <code>III</code> with <code>U</code>.</td>
<td><code>MUIIIU</code> to <code>MUUU</code></td>
</tr>
<tr class="even">
<td>4</td>
<td>x<code>UU</code>y â†’ xy</td>
<td>Remove any <code>UU</code>.</td>
<td><code>MUUU</code> to <code>MU</code></td>
</tr>
</tbody>
</table>
<p>If youâ€™ve never seen this puzzle before, you should stop for a few minutes and think on it. Grab a pen and paper and see what you can come up with. Iâ€™ve tucked the solution behind this spoiler:</p>
<div class="callout callout-style-simple callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Reveal Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Solution:</strong> It canâ€™t be done! You might be grumpy that this was a trick question, or you might have tried a few steps and intuitively come to this conclusion. Weâ€™ll discuss more formally why the task is impossible later.</p>
</div>
</div>
</div>
<p>I like to use the MU Puzzle as a model test because until now, Iâ€™ve never seen any GPT come to the correct answer. Some of them stumble into the <em>expected</em> answer but give flawed explanations. Others come to the wrong answer, usually by violating one of the rules. Even now, <a href="https://openai.com/index/introducing-o3-and-o4-mini/">o3</a>, currently billed as, â€œour most powerful reasoning model that pushes the frontier across coding, math, science, visual perception, and moreâ€ fails the puzzle.</p>
<p>When I give the puzzle to a model, I swap in different letters and present the rules conversationally. I do this to try to defend against the model regurgitation from GEB or Wikipedia. In my case, <code>M</code> becomes <code>A</code>, <code>I</code> becomes <code>B</code>, and <code>U</code> becomes <code>C</code>.</p>
<p>My prompt:</p>
<div class="long-quote">
<p>Letâ€™s play a game. You have three symbols: â€œAâ€, â€œBâ€, and â€œCâ€ which you can combine to produce strings. You start with the string â€œABâ€ and your challenge is to transform it to the string â€œACâ€. To transform it, you can use a series of transformation rules. You donâ€™t have to use every rule, and you may use any rule multiple times. Here are the available transformation rules: Rule 1: You may add â€œCâ€ to the end of any string that currently ends in â€œBâ€. For example, you may transform â€œABâ€ to â€œABCâ€. Rule 2: You may double the portion of the string that follows â€œAâ€. For example, you may transform â€œABCâ€ to â€œABCBCâ€. Rule 3: You may replace any single instance of the substring â€œBBBâ€ with â€œCâ€. For example, you may transform â€œACBBBCâ€ to â€œACCCâ€. Rule 4: You may remove any single instance of the substring â€œCCâ€. For example, you may transform â€œACCCâ€ to â€œACâ€. Your task is to come up with a series of transformation steps to convert the string â€œABâ€ to â€œACâ€. Please share what steps can solve this.</p>
</div>
<p>After <a href="https://chatgpt.com/share/68070559-e284-8002-9f44-d0bd8ace53e1">thinking</a> for <strong>3 minutes and 11 seconds</strong> o3 declared victory:</p>
<div class="long-quote">
<p>Hereâ€™s a clean sequence that turns <code>AB</code> into <code>AC</code>, using only the allowed rules. I annotate each step with the rule that was applied.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 20%">
<col style="width: 27%">
<col style="width: 51%">
</colgroup>
<thead>
<tr class="header">
<th>Step</th>
<th>String</th>
<th>What happened</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td><code>AB</code></td>
<td>start</td>
</tr>
<tr class="even">
<td>1</td>
<td><code>ABB</code></td>
<td>Rule&nbsp;2 â€“ doubled everything after <code>A</code> (â€œBâ€ â†’ â€œBBâ€)</td>
</tr>
<tr class="odd">
<td>2</td>
<td><code>ABBBB</code></td>
<td>Rule&nbsp;2 again â€“ doubled â€œBBâ€ â†’ â€œBBBBâ€</td>
</tr>
<tr class="even">
<td>3</td>
<td><code>ABBBBBBBB</code></td>
<td>Rule&nbsp;2 a third time â€“ doubled â€œBBBBâ€ â†’ â€œBBBBBBBBâ€ (now 8&nbsp;Bâ€™s in a row)</td>
</tr>
<tr class="odd">
<td>4</td>
<td><code>ACBBBBBB</code></td>
<td>Rule&nbsp;3 â€“ replaced the first â€œBBBâ€ with â€œCâ€</td>
</tr>
<tr class="even">
<td>5</td>
<td><code>ACCBBB</code></td>
<td>Rule&nbsp;3 â€“ replaced the next â€œBBBâ€ with â€œCâ€</td>
</tr>
<tr class="odd">
<td>6</td>
<td><code>ACCC</code></td>
<td>Rule&nbsp;3 â€“ replaced the last â€œBBBâ€ with â€œCâ€</td>
</tr>
<tr class="even">
<td>7</td>
<td><code>AC</code></td>
<td>Rule&nbsp;4 â€“ removed one â€œCCâ€ pair</td>
</tr>
</tbody>
</table>
<p>After step&nbsp;7 the string is exactly <code>AC</code>, so the puzzle is solved.</p>
</div>
<p>See the problem?</p>
<p>Step Four violates Rule 3. After Step Three, the string is <code>ABBBBBBBB</code>. o3 then claimed to apply â€œRule 3 â€“ replaced the first â€˜BBBâ€™ with â€˜Câ€™â€ to yield <code>ACBBBBBB</code>. But it didnâ€™t replace the first â€˜BBBâ€™. It only replaced the first â€˜BBâ€™.</p>
<p>This kind of error is characteristic of a broader failure mode seen across GPT models: a tendency toward <em>approximate rule-matching</em> rather than strict symbolic fidelity. The model recognizes the general shape of a rule, in this case, something about repeating <code>B</code>s being collapsible, but it doesnâ€™t reliably enforce the exact conditions. Instead of replacing a full <code>BBB</code> triplet, it replaced only two <code>B</code>s, violating Rule 3 while still producing something that looks right. This isnâ€™t just a hallucination; itâ€™s more like a form of <em>syntactic overgeneralization</em>. It suggests that the model is reasoning through fuzzy analogies to rules, rather than maintaining crisp internal representations of symbolic constraints.</p>
<p>This is exactly the kind of reasoning Hofstadter warned about: systems that operate on syntactic structure without deeper semantic control can seem smart, until they arenâ€™t.</p>
<p>The other bad answer Iâ€™ve seen is the model will try for a while, generating endlessly long strings, and then just give up. Itâ€™ll declare â€œunsolvable!â€ on the grounds of it tried for a while.</p>
<p>But <strong>o4-mini-high</strong> got it. After <a href="https://chatgpt.com/share/68070581-856c-8002-833d-a7385adb7c02">thinking</a> for <strong>1 minute and 40 seconds</strong>:</p>
<div class="long-quote">
<p>Letâ€™s first look at what these rules do to the number of&nbsp;Bâ€™s in your string:</p>
<ul>
<li><strong>Rule&nbsp;2</strong> (doubling after&nbsp;A) takes a string with (b)&nbsp;Bâ€™s and turns it into one with (2b)&nbsp;Bâ€™s.<br>
</li>
<li><strong>Rule&nbsp;3</strong> (replacing â€œBBBâ€ with â€œCâ€) removes exactly&nbsp;3&nbsp;Bâ€™s.<br>
</li>
<li>Rules&nbsp;1 and&nbsp;4 never touch the Bâ€‘count.</li>
</ul>
<p>So if you start with exactly&nbsp;1&nbsp;B (in â€œABâ€), then after using Rule&nbsp;2 (k)&nbsp;times and Rule&nbsp;3 (m)&nbsp;times (in any order), the total Bâ€‘count will be<br>
<span class="math display">\[
   1\cdot2^k \;-\;3\,m
\]</span> because youâ€™ve doubled the Bâ€™s (k)&nbsp;times and subtracted three Bâ€™s each time you applied Rule&nbsp;3. To end up with zero Bâ€™s (as you must, since â€œACâ€ has no Bâ€™s) youâ€™d need<br>
<span class="math display">\[
   2^k \;=\;3\,m.
\]</span> But <span class="math inline">\(2^k\)</span> is never divisible by&nbsp;3, so there is <strong>no</strong> choice of nonnegative integers <span class="math inline">\(k,m\)</span> making <span class="math inline">\(2^k=3m\)</span>. In other words, you can never get rid of that single initial B; no finite sequence of these rules will turn â€œABâ€ into â€œAC.â€</p>
<p><strong>Conclusion:</strong><br>
There is <strong>no</strong> sequence of applications of Rules&nbsp;1â€“4 that transforms â€œABâ€ into â€œAC.â€</p>
</div>
<p>Not only is this the correct answer, but itâ€™s the correct <em>reasoning</em> behind the answer.</p>
<p>Hofstadter used the MU Puzzle to demonstrate the contrast between interpretation on the syntactic level of symbols and on the semantic level of meanings. This seems very relevant to studying LLMs!</p>
<p>When dealing only in syntax there is nothing that would cause the LLM to infer the puzzleâ€™s insolvability. It could churn away within the system, generating longer and longer valid strings, and never actually show that <code>MU</code> (or, <code>AC</code>) canâ€™t be created.</p>
<p>If youâ€™re like me, you probably tried a number of different iterations before eventually suspecting that the puzzle might not have a solution. Hofstadter referred to this as, â€œjumping out of the systemâ€, the idea of reasoning about the system, rather than working within it. Depending on how long you toiled at the game, you might have discovered the ability (or inability) to divide by 3 is key to the process. And at that point, you would be thinking on the semantic level of the system.</p>
<p>Much of GEB is built around the idea of the MU Puzzle, and itâ€™s used as a grounding point to explain <a href="https://en.wikipedia.org/wiki/G%C3%B6del%27s_incompleteness_theorems">GÃ¶delâ€™s Incompleteness Theorems</a>. But an approachable explanation to its insolvability is:</p>
<ul>
<li>Our desired string contains zero <code>I</code>s; 0 is divisible by 3.</li>
<li>Our starting string contains one <code>I</code>; 1 is not divisible by 3</li>
<li>Only Rule 2 and Rule 3 change the number of <code>I</code>s.</li>
<li>Rule 2 doubles the number of <code>I</code>s.</li>
<li>Doubling a number that is not divisible by 3 does not make it divisible by 3.</li>
<li>Rule 3 reduces the number of <code>I</code> by 3.</li>
<li>Subtracting 3 from a number that is not divisible by 3 does not make it divisible by 3.</li>
</ul>
<p>Since there is no series of transformations that make the number of <code>I</code>s divisible by 3, there is no series of transformations that produce <code>MU</code>.</p>
<p>Which is exactly what <strong>o4-mini-high</strong> said!</p>
<p>This echoes Hofstadterâ€™s deeper point: the MU Puzzle is a toy model for GÃ¶delâ€™s Incompleteness Theorems. Within the formal system of applying the four rules mechanically, thereâ€™s no way to derive the string <code>MU</code>. But from outside the system, we can <em>see</em> and <em>prove</em> that no such derivation exists. The puzzleâ€™s unsolvability is a true statement that cannot be proven from within the rules themselves. Thatâ€™s GÃ¶delâ€™s move: constructing a statement that is unprovable from within the system, yet evidently true when viewed from a meta-level. Whatâ€™s striking is that <strong>o4-mini-high</strong> not only refused to be tricked into endless symbol manipulation, but it also <em>appeared</em> to jumped to this higher level of reasoning â€” the â€œsemanticâ€ frame â€” and explained <em>why</em> the goal was unreachable.</p>
<p>Iâ€™m not claiming AGI. Maybe the tensors just memorized enough puzzles of this shape. But Iâ€™ve tested this one on dozens of models over the years, and this is the first time Iâ€™ve seen a GPT both identify the impossibility <em>and</em> explain why. I think thatâ€™s pretty cool.</p>
<p>Computers!</p>



</main> <!-- /main -->
<div>
    <hr>
    <p class="post-footer">ğŸ–¤ Thank you for reading a personal blog. This post was written in a specific time and place. I reserve the right to learn new things and to change my mind. This site has no traffic analytics, social trackers, or ads. If you enjoyed this post, please consider sharing it however you like to share posts.</p>
</div>
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "î§‹";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/matthodges\.com");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
            // target, if specified
            link.setAttribute("target", "_blank");
            if (link.getAttribute("rel") === null) {
              link.setAttribute("rel", "noopener");
            }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
<p>Copyright 2025, Matt Hodges</p>
</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>